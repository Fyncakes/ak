{% extends "base.html" %}

{% block title %}FynCakes{% endblock %}

{% block head_extra %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/homepage.css') }}">
{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="hero-video-container">
        <video autoplay loop muted playsinline poster="{{ url_for('static', filename='FynCakes/gettyimages-547421170-612x612.jpg') }}">
            <source src="{{ url_for('static', filename='FynCakes/fyncakes.mp4') }}" type="video/mp4" />
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1>Welcome to FynCakes</h1>
        <p>Where every slice is a piece of art, crafted with passion.</p>
        <a href="{{ url_for('routes.customer') }}" class="cta-button">Explore Our Cakes</a>
    </div>
</section>

<section class="features-container">
    <h2 class="section-title">Our Commitment to Quality</h2>
    <div class="features-grid">
        
        <a href="{{ url_for('routes.learning_class') }}" class="feature-card-link">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-graduation-cap"></i></div>
                <h3>Online Baking Class</h3>
                <p>Join our 3-week course to turn your passion into professional skill. Click to learn more!</p>
            </div>
        </a>

        <a href="{{ url_for('routes.tasting_events') }}" class="feature-card-link">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-magic"></i></div>
                <h3>Cake Tasting & Design</h3>
                <p>Your vision, our craft. Join our exclusive tasting events to discover unique flavors and design the custom cake of your dreams.</p>
            </div>
        </a>
        
        <a href="{{ url_for('routes.wedding_gallery') }}" class="feature-card-link">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-ring"></i></div>
                <h3>Wedding & Special Occasions</h3>
                <p>Let us craft the perfect centerpiece for your most memorable events. Explore our wedding gallery.</p>
            </div>
        </a>

    </div>
</section>

<!-- NEW: Statistics Section -->
<section class="stats-section">
    <div class="stats-container">
        <div class="stat-item">
            <div class="stat-number">{{ total_cakes }}+</div>
            <div class="stat-label">Cake Varieties</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">{{ total_customers }}+</div>
            <div class="stat-label">Happy Customers</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">{{ total_orders }}+</div>
            <div class="stat-label">Orders Delivered</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">5â˜…</div>
            <div class="stat-label">Average Rating</div>
        </div>
    </div>
</section>

<!-- NEW: Featured Cakes Section -->
{% if featured_cakes %}
<section class="featured-cakes-section">
    <h2 class="section-title">Our Featured Cakes</h2>
    <div class="featured-cakes-grid">
        {% for cake in featured_cakes[:3] %}
        <a href="{{ url_for('routes.cake_details', cake_id=cake._id) }}" class="featured-cake-card">
            <div class="featured-cake-image">
                <img src="{{ cake.image }}" alt="{{ cake.name }}" loading="lazy">
            </div>
            <div class="featured-cake-info">
                <h3>{{ cake.name }}</h3>
                <p class="featured-cake-price">Shs {{ "{:,.0f}".format(cake.price|int) }}</p>
            </div>
        </a>
        {% endfor %}
    </div>
    <div class="featured-cakes-cta">
        <a href="{{ url_for('routes.customer') }}" class="cta-button">View All Cakes</a>
    </div>
</section>
{% endif %}

<!-- Recent Comments Section (Database-driven testimonials) -->
<section class="recent-comments-section">
    <div class="container">
        <h2>What Our Customers Say</h2>
        <p>Recent feedback from our valued customers</p>
        
        {% if recent_comments %}
        <div class="comments-grid">
            {% for comment in recent_comments %}
            <div class="comment-card">
                <div class="comment-header">
                    <h4>{{ comment.name }}</h4>
                    <div class="comment-rating">
                        {% for i in range(comment.rating) %}
                        <i class="fas fa-star"></i>
                        {% endfor %}
                    </div>
                </div>
                <p class="comment-text">"{{ comment.comment }}"</p>
                <small class="comment-date">{{ comment.created_at }}</small>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="no-comments">
            <p>No recent comments yet. Be the first to share your experience!</p>
        </div>
        {% endif %}
    </div>
</section>

<!-- NEW: Newsletter Signup Section -->
<section class="newsletter-section">
    <div class="newsletter-container">
        <h2>Stay Sweet with FynCakes</h2>
        <p>Get the latest updates on new cake flavors, special offers, and baking tips delivered to your inbox!</p>
        <form class="newsletter-form" id="newsletter-form">
            <input type="email" placeholder="Enter your email address" required class="newsletter-input">
            <button type="submit" class="newsletter-button">Subscribe</button>
        </form>
        <p class="newsletter-disclaimer">We respect your privacy. Unsubscribe at any time.</p>
    </div>
</section>


<section class="cta-section">
    <h2>Ready for a Taste of Perfection?</h2>
    <p>Browse our gallery of delicious, handcrafted cakes and find the perfect centerpiece for your next celebration.</p>
    <a href="{{ url_for('routes.customer') }}" class="cta-button-alt">View All Cakes</a>
</section>

{% endblock %}

{% block scripts %}
<script>
    // Newsletter signup functionality
    document.getElementById('newsletter-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = this.querySelector('.newsletter-input').value;
        
        // Simple validation
        if (!email || !email.includes('@')) {
            alert('Please enter a valid email address.');
            return;
        }
        
        // Show success message (in a real app, this would send to server)
        alert('Thank you for subscribing! You\'ll receive our latest updates soon.');
        this.reset();
    });
    
    // Animate statistics on scroll
    function animateStats() {
        const stats = document.querySelectorAll('.stat-number');
        stats.forEach(stat => {
            const target = parseInt(stat.textContent.replace(/\D/g, ''));
            let current = 0;
            const increment = target / 50;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    stat.textContent = target + '+';
                    clearInterval(timer);
                } else {
                    stat.textContent = Math.floor(current) + '+';
                }
            }, 30);
        });
    }
    
    // Trigger animation when stats section is visible
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                animateStats();
                observer.unobserve(entry.target);
            }
        });
    });
    
    const statsSection = document.querySelector('.stats-section');
    if (statsSection) {
        observer.observe(statsSection);
    }
</script>
{% endblock %}