{% extends "base.html" %}

{% block title %}Edit Cake - Admin{% endblock %}

{% block head_extra %}
    <!-- Link to the new dedicated stylesheet for this page -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/edit_cake.css') }}" />
{% endblock %}

{% block content %}
<div class="edit-container">
    <div class="edit-card">
        <h2>Edit '{{ cake.name }}'</h2>
        <p class="subtitle">Update the details for this product.</p>

        <!-- The form now needs 'enctype' to handle file uploads -->
        <form method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label for="cake-name">Cake Name</label>
                <input type="text" id="cake-name" name="cake_name" value="{{ cake.name }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="cake-description">Description</label>
                <textarea id="cake-description" name="cake_description" rows="4" class="form-control" required>{{ cake.description }}</textarea>
            </div>

            <div class="form-group">
                <label for="cake-price">Price (UGX)</label>
                <input type="number" id="cake-price" name="cake_price" step="100" value="{{ cake.price }}" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="cake-category">Category</label>
                <select id="cake-category" name="cake_category" class="form-control" required>
                    <option value="" disabled {% if not cake.category %}selected{% endif %}>Select a category...</option>
                    {% set categories = ["Ready Cake", "Mousse & Cheesecake", "Mini Cake", "Wedding Cake"] %}
                    {% for category in categories %}
                        <option value="{{ category }}" {% if category == cake.get('category') %}selected{% endif %}>
                            {{ category }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Current Image</label>
                <div class="current-image-preview">
                    <img src="{{ cake.image }}" alt="Current image for {{ cake.name }}">
                </div>
            </div>
            <div class="form-group">
                <label for="cake-image">Upload New Image (Optional)</label>
                <input type="file" id="cake-image" name="cake_image" class="form-control" accept="image/*">
                <small>Only choose a file if you want to replace the current image.</small>
            </div>

            <div class="form-actions">
                <a href="{{ url_for('routes.manage_cakes') }}" class="btn-cancel">Cancel</a>
                <button type="submit" class="btn-update">Update Cake</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

